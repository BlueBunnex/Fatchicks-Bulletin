<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Fediverse (Mastodon?) App</title>
    <style>
        body { width: 45em; margin: auto; }
    </style>
    <script>

        // Tutorial: https://docs.joinmastodon.org/client/intro/

        // /api/v1/accounts/lookup?acct=johnnnnn

        // /api/v1/timelines/public
        // /api/v1/accounts/113480132212449271/statuses
        // /api/v1/timelines/tag/sillycat?limit=5

        async function init() {

            const statusInsert = document.getElementById("status-insert");
            
            const response = await fetch("https://mastodon.social/api/v1/timelines/tag/oppai?limit=40",
                {
                    method: "GET",
                    headers: {
                        "content-type": "application/json"
                    }
                }
            );
    
            if (response.status == 200) {
    
                const statuses = await response.json();
    
                console.log(statuses);
    
                for (const status of statuses) {
    
                    let imageEmbed = "";
    
                    for (const media of status.media_attachments) {
    
                        if (media.type === "image")
                            imageEmbed += `<img height="200" src="${ media.url }">`;
                    }
    
                    statusInsert.innerHTML += `
                        <div style="margin: 1em 0; padding: 1em; border: 1px solid black; border-radius: 8px;">
                            <strong>${ status.account.username } (${ status.account.url })</strong>
                            <br>
                            ${ status.content }
                            <br>
                            ${ imageEmbed }
                        </div>
                    `;
                }
    
            } else {
    
                document.body.innerHTML += "Error " + response.status;
            }
        }
    </script>
</head>
<body onload="init()">

    <div style="display: flex; gap: 4px;">
        <button style="flex: 1;" onclick="">Public Feed</button>
        <input style="flex: 1;" type="text" placeholder="Search @users or #hashtags">
    </div>

    <div id="status-insert"></div>
    
</body>
</html>
